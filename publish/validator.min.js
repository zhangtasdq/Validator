!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.RuleValidator=e():t.RuleValidator=e()}(window,function(){return function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";e.__esModule=!0;var o=r(1),n=r(4),u=r(5),i=function(){function t(t){void 0===t&&(t={}),this.executorFactory=new o.default,this.operatorFactory=new u.default,this.parser=new n.default,this.contextData=t,this.currentRule={}}return t.prototype.addRule=function(t,e){this.parser.setExecutorFactory(this.executorFactory),this.parser.setOperatorFactory(this.operatorFactory),this.currentRule[t]=this.parser.parse(e)},t.prototype.run=function(t,e,r,o){var n=this.currentRule[t];if(!n)throw new Error("规则 "+t+" 不存在!");var u=n.execute(e,this.contextData);u.status?r():o&&o(u)},t.prototype.addGroupExecutor=function(t,e){this.executorFactory.addGroupExecutor(t,e)},t.prototype.addOperator=function(t,e){this.operatorFactory.addOperator(t,e)},t}();e.default=i},function(t,e,r){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();e.__esModule=!0;var n=r(2),u=r(3),i=function(t,e,r){for(var o={status:!0},n=0,u=t.length;n<u&&(o=t[n].execute(e,r)).status;++n);return o},a=function(t,e,r){for(var o=null,n=0,u=t.length;n<u&&!(o=t[n].execute(e,r)).status;++n);return o},c=function(){function t(){this.groupExecutors={},this.addGroupExecutor("and",i),this.addGroupExecutor("or",a)}return t.prototype.groupExecutorBuilder=function(t,e){return function(r){function n(){return r.call(this,t,e)||this}return o(n,r),n}(n.default)},t.prototype.addGroupExecutor=function(t,e){this.groupExecutors[t]=this.groupExecutorBuilder(t,e)},t.prototype.buildSingleExecutor=function(t,e){return t=t,new u.default("singleExecutor",t,e)},t.prototype.buildGroupExecutor=function(t){var e=this.groupExecutors[t];if(!e)throw new Error("组 "+t+" 不存在!");return new e},t}();e.default=c},function(t,e,r){"use strict";e.__esModule=!0;var o=function(){function t(t,e){this.name=t,this.executor=e,this.childrens=[]}return t.prototype.execute=function(t,e){return this.executor(this.childrens,t,e)},t.prototype.addChild=function(t){this.childrens.push(t)},t}();e.default=o},function(t,e,r){"use strict";e.__esModule=!0;var o=function(){function t(t,e,r){this.name=t,this.rule=e,this.operator=r}return t.prototype.getObjValueByPath=function(t,e){for(var r=(e=(e=e.replace(/\[(\w+)\]/,".$1")).replace(/^\./,"")).split("."),o=t,n=0,u=r.length;n<u;++n){var i=r[n];if(!o.hasOwnProperty(i))break;o=o[i]}return n===r.length?o:null},t.prototype.getCurrentValue=function(t){return this.getObjValueByPath(t,this.rule.key)},t.prototype.getTargetValue=function(t){return this.rule.targetType&&"plainValue"!==this.rule.targetType?this.getObjValueByPath(t,this.rule.targetValue):this.rule.targetValue},t.prototype.execute=function(t,e){var r=this.getCurrentValue(t),o=this.getTargetValue(e);return this.operator.run(r,o)?{status:!0}:{status:!1,errorMsg:this.rule.errorMsg}},t}();e.default=o},function(t,e,r){"use strict";e.__esModule=!0;var o=function(){function t(){}return t.prototype.parse=function(t){var e=Object.keys(t);return 1===e.length?this.parseGroup(e[0],t[e[0]]):this.parseSingle(t)},t.prototype.parseGroup=function(t,e){for(var r=this.executorFactory.buildGroupExecutor(t),o=0,n=e.length;o<n;++o)r.addChild(this.parse(e[o]));return r},t.prototype.parseSingle=function(t){var e=this.operatorFactory.getOperator(t.operator);return this.executorFactory.buildSingleExecutor(t,e)},t.prototype.setExecutorFactory=function(t){this.executorFactory=t},t.prototype.setOperatorFactory=function(t){this.operatorFactory=t},t}();e.default=o},function(t,e,r){"use strict";e.__esModule=!0;var o=r(6),n=function(t,e){return t===e},u=function(t,e){return t==e},i=function(t,e){return t!==e},a=function(t,e){return t<e},c=function(t,e){return t<=e},s=function(t,e){return t>e},p=function(t,e){return t>=e},f=function(t,e){return t.indexOf&&-1!==t.indexOf(e)},l=function(){function t(){this.operators={},this.addOperator("equal",n),this.addOperator("shadowEqual",u),this.addOperator("notEqual",i),this.addOperator("lessThan",a),this.addOperator("lessThanInclusive",c),this.addOperator("greaterThan",s),this.addOperator("greaterThanInclusive",p),this.addOperator("contains",f)}return t.prototype.addOperator=function(t,e){this.operators[t]=new o.default(t,e)},t.prototype.getOperator=function(t){var e=this.operators[t];if(!e)throw new Error("操作 "+t+" 不存在!");return e},t}();e.default=l},function(t,e,r){"use strict";e.__esModule=!0;var o=function(){function t(t,e){this.name=t,this.executor=e}return t.prototype.run=function(t,e){return this.executor(t,e)},t}();e.default=o}]).default});
//# sourceMappingURL=validator.min.js.map